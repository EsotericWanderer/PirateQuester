@page "/CreateAccount"
@using PirateQuester.ViewModels;
@using System.ComponentModel.DataAnnotations;
@using Utils;
@using Newtonsoft.Json
@code{
    AccountViewModel model = new();
}

<div class="container">
    <h4 class="text-center">Create Account</h4>
    <PageTitle>PQ - Create Account</PageTitle>
    @if(Acc.AccountNames.Count == 0)
    {
        <div class="rz-background-color-danger p-3 rounded m-3">
            <h6>
                You need to create an account to use most features on Pirate Quester.
            </h6>
        </div>
    }
    <SfCard>
        <CardHeader>
            <h5 class="text-danger">
                Important!
            </h5>
        </CardHeader>
        <CardContent>
            <p>
                Backup your accounts!
            </p>
            <p>
                To read more about creating accounts safely read the documentation guide:
                <a href="https://dfk-project.gitbook.io/pirate-quester/guides/accounts/creating-an-account-exporting-an-account-from-metamask" target="_blank">
                    Creating an account
                </a>
            </p>
            <p>
                If you lose access to your keys, you've got noone to blame but yourself.
            </p>
            <p>
                Pirate Quester keeps no data backed up online, it's all on your device.
            </p>
            <p>
                It is self custodial through and through.
            </p>
        </CardContent>
    </SfCard>
    <SfCard>
        <CardContent>
            <EditForm OnValidSubmit="@(() => Create())" Model="@model">
                <h6 class="mb-1">
                    Account Name
                </h6>
                <SfTextBox @bind-Value="model.Name" TChecked="bool" />
                <h6 class="mb-1">
                    Private Key
                </h6>
                <SfTextBox Type="InputType.Password" @bind-Value="model.PrivateKey" Name="PrivateKey" />
                
                <h6 class="mb-1">
                    Password
                </h6>
                <SfTextBox Type="InputType.Password" @bind-Value="model.Password" />

                <h6 class="mb-1">
                    Re-type Password
                </h6>
                <SfTextBox Type="InputType.Password" @bind-Value="model.RecheckPassword" />

                <SfButton CssClass="e-success">
                    Create
                </SfButton>
            </EditForm>
        </CardContent>
    </SfCard>
    <SfDialog ShowCloseIcon="false" IsModal="true" @bind-Visible="@Creating" Width="50%">
        <DialogTemplates>
            <Content>
                <h4 class="text-center">Creating account for @model.Name...</h4>
                <SfSpinner Visible="true"></SfSpinner>
            </Content>
        </DialogTemplates>
    </SfDialog>
</div>